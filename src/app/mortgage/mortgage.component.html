<table mat-table [dataSource]="mortgage.loans" [trackBy]="trackByLoanId" class="calc-full-width">
    <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Name </th>
        <td mat-cell *matCellDef="let loan"> {{loan.name}} </td>
        <td mat-footer-cell *matFooterCellDef>Total</td>
    </ng-container>
    <ng-container matColumnDef="principal">
        <th mat-header-cell *matHeaderCellDef> Principal </th>
        <td mat-cell *matCellDef="let loan; let i = index;">
            <input [(ngModel)]="mortgage.loans[i].principal" class="calc-medium-width" style="width: 70px"
                type="number" />
        </td>
        <td mat-footer-cell *matFooterCellDef>
            <calc-money [amount]="mortgage.principal"></calc-money>
        </td>
    </ng-container>
    <ng-container matColumnDef="interestRate">
        <th mat-header-cell *matHeaderCellDef> Interest Rate </th>
        <td mat-cell *matCellDef="let loan; let i = index;">
            <input [(ngModel)]="mortgage.loans[i].interestRate" type="number" step="0.1" min="0" max="15"
                style="width: 40px" class="calc-medium-width" />%
        </td>
        <td mat-footer-cell *matFooterCellDef> {{mortgage.avgInterestRate | number}}% </td>
    </ng-container>
    <ng-container matColumnDef="months">
        <th mat-header-cell *matHeaderCellDef> Months </th>
        <td mat-cell *matCellDef="let loan; let i = index;">
            <input [(ngModel)]="mortgage.loans[i].months" class="calc-medium-width" type="number" min="1" />
        </td>
        <td mat-footer-cell *matFooterCellDef> {{mortgage.totalMonths}} </td>
    </ng-container>
    <ng-container matColumnDef="monthlyPayment">
        <th mat-header-cell *matHeaderCellDef> Monthly payment </th>
        <td mat-cell *matCellDef="let loan">
            <calc-money [amount]="loan.monthlyPayment"></calc-money>
        </td>
        <td mat-footer-cell *matFooterCellDef>
            <calc-money [amount]="mortgage.maxMonthlyPayment"></calc-money>
        </td>
    </ng-container>
    <ng-container matColumnDef="total">
        <th mat-header-cell *matHeaderCellDef>Total amount</th>
        <td mat-cell *matCellDef="let loan">
            <calc-money [amount]="loan.totalAmount"></calc-money>
        </td>
        <td mat-footer-cell *matFooterCellDef>
            <calc-money [amount]="mortgage.totalAmount"></calc-money>
        </td>
    </ng-container>
    <ng-container matColumnDef="removeLoan">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let loan">
            <button 
                mat-icon-button 
                (click)="mortgage.removeLoan(loan)"
                color="warn" 
                matTooltip="Remove this loan"
                aria-label="Remove this loan">
                <mat-icon>delete</mat-icon>
            </button>
        </td>
        <td mat-footer-cell *matFooterCellDef></td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedMortgageLoanColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedMortgageLoanColumns;"></tr>
    <tr mat-footer-row *matFooterRowDef="displayedMortgageLoanColumns"></tr>
</table>
<div class="margin-top-half">
    <button mat-raised-button color="primary" (click)="addLoan()">
        <mat-icon aria-hidden="false" aria-label="Plus">add</mat-icon>
        Add Loan
    </button>
</div>